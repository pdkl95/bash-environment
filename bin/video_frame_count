#!/bin/bash

use_color=false
if [[ "$1" == "-c" ]] ; then
    use_color=true
    shift
fi

FILE="$1"


infoff() {
    ffmpeg -i "${FILE}" -vcodec copy -f rawvideo -y /dev/null 2>&1
}

find_marked_section() {
    grep '^Press \[q] to stop' -A 20
}

strip_marker() {
    tail -n +2
}

raw_info_lines() {
    infoff | find_marked_section | strip_marker
}


colorize() {
    spc -t c
}


if ${use_color} ; then
    raw_info_lines | colorize
else
    raw_info_lines
fi


# Local Variables:
# mode: sh
# sh-basic-offset: 4
# sh-shell: bash
# coding: unix
# End:
